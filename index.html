<!DOCTYPE html>
<html>
<head>
  <script>
  // 自动设置窗口名称，这样发送页面就能正确获取到此窗口
  window.name = "getTuxunLinkWindow";
  </script>
  
  <meta charset="UTF-8">
  <title>给Ajuez送上爱</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; }
    input, button { padding: 10px; width: 80%; margin: 10px 0; font-size: 16px; }
  </style>
</head>
<body>
  <h2>📎 把链接给我</h2>
  <input type="text" id="link" placeholder="请输入链接">
  <button onclick="sendLink()">发送</button>
  <p id="status"></p>

  <script>
  // 监听其他页面发送的消息
  window.addEventListener('message', function(event) {
    // 可根据需要检查 event.origin，若不需要严格校验，可省略此步骤
    if (typeof event.data === "string" && event.data.indexOf("link:") === 0) {
      const receivedLink = event.data.substring(5);  // 去掉 "link:" 前缀
      const linkInput = document.getElementById("link");
      const sendBtn = document.querySelector("button");
      if (linkInput && sendBtn) {
        linkInput.value = receivedLink;
        sendBtn.click();
      }
    }
  });
  </script>

  <script>
    function sendLink() {
      const url = document.getElementById("link").value;
      if (!url.trim()) {
        document.getElementById("status").innerText = "请先输入链接。";
        return;
      }

      const botToken = "7516817008:AAEsO4y4z-7cFzF8DBiqZGdRUp__nLp5Shs";
      const chatId = 6716794732;

      fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: chatId,
          text: `📨 朋友分享的链接：\n${url}`
        })
      }).then(res => {
        if (res.ok) {
          document.getElementById("status").innerText = "✅ 链接已发送！";
        } else {
          document.getElementById("status").innerText = "❌ 发送失败。";
        }
      });
    }
  </script>
</body>
</html>
